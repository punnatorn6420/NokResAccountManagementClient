<div
  id="agent-detail-tour-container"
  class="p-6 bg-white dark:bg-black rounded-xl border border-gray-200 dark:border-zinc-800 shadow-sm"
>
  <div class="pb-4 border-b border-gray-200 dark:border-zinc-800">
    <div class="flex flex-col gap-3">
      <div class="flex items-start justify-between gap-4">
        <div class="flex gap-6">
          <button
            id="agent-detail-tour-back"
            pButton
            type="button"
            icon="pi pi-arrow-left"
            class="p-button-secondary"
            (click)="navigateToList()"
          ></button>
          <div>
            <div
              class="text-[18px] font-semibold text-slate-900 dark:text-zinc-100 leading-tight"
            >
              Agent Detail
            </div>
            <div class="text-[12px] text-slate-500 dark:text-zinc-400">
              <span class="font-medium text-slate-700 dark:text-zinc-300"
                >Purpose:</span
              >
              View agent profile information and related resources.
            </div>
          </div>
        </div>
        <div class="flex items-center gap-2">
          <button
            pButton
            icon="pi pi-compass"
            class="p-button-text p-button-sm p-button-help"
            label="Start tour"
            pTooltip="Start a quick guided tour of this page."
            tooltipPosition="bottom"
            (click)="startGuidedTour()"
          ></button>
          <div class="flex items-center gap-2">
            <button
              id="agent-detail-tour-refresh"
              pButton
              icon="pi pi-refresh"
              class="p-button-text p-button-sm"
              label="Refresh now"
              (click)="reloadAgent()"
            ></button>
          </div>
          <button
            id="agent-detail-tour-edit"
            pButton
            type="button"
            icon="pi pi-pencil"
            class="p-button p-button-primary"
            label="Edit Agent"
            (click)="navigateToEdit()"
          ></button>
        </div>
      </div>
    </div>
  </div>
  <div
    *ngIf="errorMessage"
    class="mt-4 p-3 rounded-md bg-red-50 text-red-700 border border-red-200 text-sm"
  >
    {{ errorMessage }}
  </div>
  <div *ngIf="loading" class="flex justify-center py-12">
    <p-progressSpinner></p-progressSpinner>
  </div>
  <div *ngIf="!loading && agent" class="space-y-4">
    <div class="space-y-4">
      <p-fieldset
        id="agent-detail-tour-info"
        legend="Agent Information"
        [toggleable]="false"
      >
        <div class="rounded-lg">
          <div class="space-y-1">
            <div class="grid grid-cols-12 gap-3 items-center">
              <div class="col-span-12 md:col-span-2">
                <div
                  class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
                >
                  Company Name<span class="text-slate-400 ml-1">:</span>
                </div>
              </div>
              <div class="col-span-12 md:col-span-4">
                <div
                  class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] font-medium text-slate-900 dark:text-zinc-100"
                >
                  {{ agent.companyName || "-" }}
                </div>
              </div>
              <div class="col-span-12 md:col-span-2">
                <div
                  class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
                >
                  Agency Code <span class="text-slate-400 ml-1">:</span>
                </div>
              </div>
              <div class="col-span-12 md:col-span-4">
                <div
                  class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] font-medium text-slate-900 dark:text-zinc-100"
                >
                  {{ agent.agencyCode || "-" }}
                </div>
              </div>
            </div>
            <div class="grid grid-cols-12 gap-3 items-center">
              <div class="col-span-12 md:col-span-2">
                <div
                  class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
                >
                  Agent Type<span class="text-slate-400 ml-1">:</span>
                </div>
              </div>
              <div class="col-span-12 md:col-span-4">
                <div
                  class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] font-medium text-slate-900 dark:text-zinc-100"
                >
                  {{ agent.type || "-" }}
                </div>
              </div>
              <div class="col-span-12 md:col-span-2">
                <div
                  class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
                >
                  Currency<span class="text-slate-400 ml-1">:</span>
                </div>
              </div>
              <div class="col-span-12 md:col-span-4">
                <div
                  class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] font-medium text-slate-900 dark:text-zinc-100"
                >
                  {{ agent.currency || "-" }}
                </div>
              </div>
            </div>
            <div class="grid grid-cols-12 gap-3 items-center">
              <div class="col-span-12 md:col-span-2">
                <div
                  class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
                >
                  Full Name<span class="text-slate-400 ml-1">:</span>
                </div>
              </div>
              <div class="col-span-12 md:col-span-4">
                <div
                  class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] text-slate-900 dark:text-zinc-100"
                >
                  {{ (agent.firstName || "-") + " " + (agent.lastName || "") }}
                </div>
              </div>
              <div class="col-span-12 md:col-span-2">
                <div
                  class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
                >
                  Phone Number<span class="text-slate-400 ml-1">:</span>
                </div>
              </div>
              <div class="col-span-12 md:col-span-4">
                <div
                  class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] text-slate-900 dark:text-zinc-100"
                >
                  {{ agent.phone || "-" }}
                </div>
              </div>
            </div>
            <div class="grid grid-cols-12 gap-3 items-center">
              <div class="col-span-12 md:col-span-2">
                <div
                  class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
                >
                  Assigned By<span class="text-slate-400 ml-1">:</span>
                </div>
              </div>
              <div class="col-span-12 md:col-span-2">
                <div
                  class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] text-slate-900 dark:text-zinc-100"
                >
                  {{ agent.assignedBy || "-" }}
                </div>
              </div>

              <div class="col-span-12 md:col-span-2">
                <div
                  class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
                >
                  Created At<span class="text-slate-400 ml-1">:</span>
                </div>
              </div>
              <div class="col-span-12 md:col-span-2">
                <div
                  class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] text-slate-900 dark:text-zinc-100"
                >
                  {{
                    agent.createdAt
                      ? (agent.createdAt | date: "MMM d, yyyy, HH:mm")
                      : "-"
                  }}
                </div>
              </div>
              <div class="col-span-12 md:col-span-2">
                <div
                  class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
                >
                  Last Modified At<span class="text-slate-400 ml-1">:</span>
                </div>
              </div>
              <div class="col-span-12 md:col-span-2">
                <div
                  class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] text-slate-900 dark:text-zinc-100"
                >
                  {{
                    agent.modifiedAt
                      ? (agent.modifiedAt | date: "MMM d, yyyy, HH:mm")
                      : "-"
                  }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </p-fieldset>
      <p-fieldset
        id="agent-detail-tour-address"
        legend="Address"
        [toggleable]="false"
      >
        <div class="space-y-1">
          <div class="grid grid-cols-12 gap-3 items-center">
            <div class="col-span-12 md:col-span-2">
              <div
                class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
              >
                Address 1<span class="text-slate-400 ml-1">:</span>
              </div>
            </div>
            <div class="col-span-12 md:col-span-4">
              <div
                class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] text-slate-900 dark:text-zinc-100"
              >
                {{ agent.address1 || "-" }}
              </div>
            </div>

            <div class="col-span-12 md:col-span-2">
              <div
                class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
              >
                Address 2<span class="text-slate-400 ml-1">:</span>
              </div>
            </div>
            <div class="col-span-12 md:col-span-4">
              <div
                class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] text-slate-900 dark:text-zinc-100"
              >
                {{ agent.address2 || "-" }}
              </div>
            </div>
          </div>
          <div class="grid grid-cols-12 gap-3 items-center">
            <div class="col-span-12 md:col-span-2">
              <div
                class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
              >
                City<span class="text-slate-400 ml-1">:</span>
              </div>
            </div>
            <div class="col-span-12 md:col-span-4">
              <div
                class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] text-slate-900 dark:text-zinc-100"
              >
                {{ agent.city || "-" }}
              </div>
            </div>
            <div class="col-span-12 md:col-span-2">
              <div
                class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
              >
                State / Province<span class="text-slate-400 ml-1">:</span>
              </div>
            </div>
            <div class="col-span-12 md:col-span-4">
              <div
                class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] text-slate-900 dark:text-zinc-100"
              >
                {{ agent.state || "-" }}
              </div>
            </div>
          </div>
          <div class="grid grid-cols-12 gap-3 items-center">
            <div class="col-span-12 md:col-span-2">
              <div
                class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
              >
                Portal Code<span class="text-slate-400 ml-1">:</span>
              </div>
            </div>
            <div class="col-span-12 md:col-span-2">
              <div
                class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] text-slate-900 dark:text-zinc-100"
              >
                {{ agent.postalCode || "-" }}
              </div>
            </div>

            <div class="col-span-12 md:col-span-2">
              <div
                class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
              >
                Country Code<span class="text-slate-400 ml-1">:</span>
              </div>
            </div>
            <div class="col-span-12 md:col-span-2">
              <div
                class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] text-slate-900 dark:text-zinc-100"
              >
                {{ agent.countryCode || "-" }}
              </div>
            </div>
            <div class="col-span-12 md:col-span-2">
              <div
                class="justify-between min-h-[30px] flex items-center px-2 text-[12px] font-semibold text-primary dark:text-zinc-300 bg-slate-50 dark:bg-zinc-900 border border-transparent"
              >
                Region<span class="text-slate-400 ml-1">:</span>
              </div>
            </div>
            <div class="col-span-12 md:col-span-2">
              <div
                class="content-center justify-between min-h-[30px] w-full rounded-md border border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-900 px-3 py-2 text-[13px] text-slate-900 dark:text-zinc-100"
              >
                {{ agent.region || "-" }}
              </div>
            </div>
          </div>
        </div>
      </p-fieldset>
    </div>

    <div class="border border-gray-200 rounded-lg dark:border-zinc-800">
      <div class="px-4 pb-4">
        <p-tabView
          id="agent-detail-tour-tabs"
          styleClass="!bg-transparent !border-0 text-sm"
        >
          <p-tabPanel header="RES Accounts">
            <app-agent-res-accounts
              [agentId]="agentId"
            ></app-agent-res-accounts>
          </p-tabPanel>
          <p-tabPanel header="Contact Emails">
            <app-agent-contact-emails
              [agentId]="agentId"
              (primaryEmailChange)="onPrimaryEmailChange($event)"
            ></app-agent-contact-emails>
          </p-tabPanel>
          <p-tabPanel header="API Keys">
            <app-agent-api-keys [agentId]="agentId"></app-agent-api-keys>
          </p-tabPanel>
        </p-tabView>
      </div>
    </div>
  </div>
  <div *ngIf="!loading && !agent && !errorMessage" class="py-12 text-center">
    <p class="text-sm text-gray-500 dark:text-zinc-400">
      No agent information available.
    </p>
  </div>
  <div
    id="agent-detail-tour-last-refreshed"
    class="flex justify-end items-center gap-2 py-2"
  >
    <small class="text-gray-500"
      >Last refreshed:
      {{ lastRefreshedAt ? (lastRefreshedAt | date: "short") : "-" }}</small
    >
  </div>
</div>
